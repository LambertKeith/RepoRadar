---
description: 
globs: 
alwaysApply: true
---

# Your rule content


# **GitHub趋势项目智能分析系统（个人版）**  
**适用场景**：个人开发者PC（Windows/macOS/Linux）  
**核心需求**：  
1. 零成本、纯本地化运行  
2. 自动适配CPU/GPU硬件  
3. 最小化运维复杂度  

---

## **一、系统架构**  
### 1. 硬件适配层  
```mermaid
graph LR
    A[硬件检测] --> B{GPU可用?}
    B -->|Yes| C[启用CUDA加速]
    B -->|No| D[使用CPU优化模式]
    C & D --> E[统一处理管道]
```

### 2. 模块组成  
| 模块           | CPU模式实现方案          | GPU加速方案              | 资源占用               |
|----------------|-------------------------|-------------------------|----------------------|
| **数据采集**   | Python请求+本地缓存      | 无需GPU                 | <500MB内存           |
| **文本向量化** | ONNX量化模型            | HuggingFace CUDA模型    | GPU显存2-6GB可选     |
| **向量存储**   | ChromaDB内存模式        | 同左（GPU不参与存储）   | 每万条约100MB内存    |
| **检索界面**   | 本地Web页面（Gradio）   | 同左                    | 共享浏览器资源       |

---

## **二、关键设计决策**  
### 1. **硬件自适应策略**  
- **自动检测逻辑**：  
  - 首次运行时检测`torch.cuda.is_available()`  
  - 根据显存大小自动选择模型精度（>4GB显存启用FP16）  
- **降级机制**：  
  - GPU内存不足时自动切换至CPU处理  
  - 记录硬件日志供后续优化参考  

### 2. **资源节约设计**  
- **模型选择**：  
  - 默认CPU：`all-MiniLM-L6-v2`（ONNX量化版，80MB）  
  - GPU可选：`paraphrase-multilingual-MiniLM-L12-v2`（适合多语言）  
- **数据分块**：  
  - 超过1万条数据时自动启用磁盘缓存  
  - 最近使用数据保留在内存中  

### 3. **个人化扩展接口**  
- **自定义模型挂载**：  
  - 支持将Fine-tune后的模型放入`./models/`目录自动加载  
- **插件系统**：  
  - 通过`config.yaml`定义新数据源（如GitLab趋势页）  

---

## **三、部署与运行方案**  
### 1. **环境准备**  
- **最小化依赖**：  
  ```bash
  # 仅需安装以下包（conda/pip均可）
  pytorch-cpu|pytorch-cuda   # 根据硬件二选一
  sentence-transformers>=2.2.0
  chromadb>=0.4.0
  gradio>=3.0
  ```

### 2. **启动流程**  
```bash
# 自动检测硬件并选择最优模式
python run.py --auto_device

# 手动指定模式（调试用）
python run.py --device cpu|gpu
```

### 3. **硬件资源占用参考**  
| 任务规模       | CPU模式（i5-12400） | GPU模式（RTX 3060） |  
|----------------|---------------------|---------------------|  
| 每日100个项目  | 内存占用<1GB        | 显存占用1.2GB       |  
| 历史数据1万条  | 磁盘占用500MB       | 同左                |  
| 并发检索请求   | 支持3-5路           | 支持10+路           |  

---

## **四、演进与维护**  
### 1. **数据更新策略**  
- **智能增量更新**：  
  - 每隔6小时自动检查GitHub趋势页  
  - 仅处理新增/变动的仓库  

### 2. **个人知识库优化**  
- **手动标记系统**：  
  - 可为项目打标签（如"计算机视觉"、"推荐系统"）  
  - 标签参与向量相似度计算  

### 3. **长期维护建议**  
- **模型升级**：  
  - 每年评估一次新发布的轻量模型  
- **数据备份**：  
  - 定期导出ChromaDB数据到`./backups/`  

---

## **五、方案优势总结**  
1. **即装即用**：无需配置服务器或购买云服务  
2. **硬件友好**：老旧PC也能流畅运行基础功能  
3. **隐私保障**：所有数据仅存储在本地  
4. **无缝扩展**：插入GPU立即获得加速效果  

如需具体实施时的工具链详细版本号或故障排查指南，可提供补充说明。该方案已为个人开发者环境优化掉所有非必要组件，平衡功能性与易用性。